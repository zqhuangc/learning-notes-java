https://mp.weixin.qq.com/s/JOZeseLwZutVMocqJjFEZw

XPathParser 是 Mybatis 核心的 xml 解析器
SqlSessionFactoryBuilder 为 Mybatis 入口类

typeHandlers
BaseTypeHandler



### sql执行过程

MapperProxy

SqlSessionTemplate  
委托  
SqlSessionUtils => DefaultSqlSessionFactory.openSession(executorType);//simple 动态代理类DefaultSqlSession，实现SqlSession

CachingExecutor SimpleExecutor（有3种执行器，ReuseExecutor，SimpleExecutor，CachingExecutor）

RoutingStatementHandler=>委托给PreparedStatementHandler，DefaultParameterHandler初始化连接

DefaultResultSetHandler, 执行结果查询, 合并结果集等

handleLocallyCachedOutputParameters，只处理存储过程和函数调用的出参, 因为存储过程和函数的返回不是通过ResultMap而是ParameterMap来的，所以只要把缓存的非IN模式参数取出来设置到parameter对应的属性上即可

mybatis内置了JNDI、POOLED、UNPOOLED三种类型的数据源,其中POOLED对应的实现为org.apache.ibatis.datasource.pooled.PooledDataSource,它是mybatis自带实现的一个同步、线程安全的数据库连接池, 一般在生产中,我们会使用dbcp或者druid连接池


###spring管理 SqlSession和Mapper的生命周期
MapperScannerConfigurer->xml  
MapperScannerRegistrar->注解
mapperscan


mapper 在Spring管理下为全局singlton， 作用域原为 method 级  sqlsession 在transaction下为  transaction范围 ，原为request/method