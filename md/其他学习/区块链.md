http://www.ruanyifeng.com/blog/2017/12/blockchain-tutorial.html
## 概念
区块链是一个去中心化并保证所有数据不能被篡改的分布式系统。

通俗的来说，可以把区块链看成是互联化的公开账本，一块一块的账本，每一块写满了交易记录，连在一起成了一条链就是区块链。

## 区块
区块链由一个个区块（block）组成。区块很像数据库的记录，每次写入数据，就是创建一个区块

每个区块包含两个部分。
* 区块头（Head）：记录当前区块的特征值
* 区块体（Body）：实际数据

区块头包含了当前区块的多项特征值。
* 生成时间(当前时间)
* 实际数据（即区块体）的哈希
* 上一个区块的哈希
  ...
  区块哈希 区块链的哈希长度是256位
  Hash = SHA256( **区块头** )



区块链就像一个单向链表，一个数据块中保存着三个信息。
真正的数据。
自己的地址（或是ID）。
前一个数据块的地址



## 特点：
* 去中心化（Decentralized）：没有中介机构，所有节点的权利和义务都相等，任一节点停止工作都会不影响系统整体的运作  

去信任（Trustless）：系统中所有节点之间无需信任也可以进行交易，因为数据库和整个系统的运作是公开透明的，在系统的规则和时间范围内，节点之间无法欺骗彼此
区块链是通过共识机制来实现的去信任，简单来说就是让众多参与者达成共识的机制，实现不信任才是最大的信任。

集体维护（Collectively Maintain）：系统是由其中所有具有维护功能的节点共同维护的，系统中所有人共同参与维护工作；

可靠数据库（Reliable 
Database）：系统中每一个节点都拥有最新的完整数据库拷贝，修改单个节点的数据库是无效的，因为系统会自动比较，认为最多次出现的相同数据记录为真。  

* 不可篡改
  使用密码学哈希函数验证信息完整性，根据哈希函数的性质，没有人能够伪造出另一个消息具有同样的哈希值，也就是说篡改过的数据完全不可能通过哈希校验。
  使用非对称加密来进行信息加解密和验证身份，非对称加密技术中的公钥是公开的，而私钥就是确定使用者信息了。

```
以数字签名为例，某个消息后面，发信人对这个消息做哈希运算，然后用私钥加密。接着收信人首先对消息进行哈希运算，接着用相应的公钥解密数字签名，再对比两个哈希值，如果相同，就代表这个消息是本人发出的而且没有被篡改过。
```

公有链、私有链、侧链

固定发行量



 "区块链技术" 和 "工作量证明共识机制" 。

## 采矿/挖矿

由于必须保证节点之间的同步，所以新区块的添加速度不能太快。试想一下，你刚刚同步了一个区块，准备基于它生成下一个区块，但这时别的节点又有新区块生成，你不得不放弃做了一半的计算，再次去同步。因为每个区块的后面，只能跟着一个区块，你永远只能在最新区块的后面，生成下一个区块。所以，你别无选择，一听到信号，就必须立刻同步。
所以，区块链的发明者中本聪（这是假名，真实身份至今未知）故意让添加新区块，变得很困难。他的设计是，平均每10分钟，全网才能生成一个新区块，一小时也就六个。
这种产出速度不是通过命令达成的，而是故意设置了海量的计算。也就是说，只有通过极其大量的计算，才能得到当前区块的有效哈希，从而把新区块添加到区块链。由于计算量太大，所以快不起来。
这个过程就叫做采矿（mining），因为计算有效哈希的难度，好比在全世界的沙子里面，找到一粒符合条件的沙子。计算哈希的机器就叫做矿机，操作矿机的人就叫做矿工。

### 难度系数
区块头包含一个难度系数（difficulty），这个值决定了计算哈希的难度。举例来说，第100000个区块的难度系数是 14484.16236122。  
区块链协议规定，使用一个常量除以难度系数，可以得到目标值（target）。显然，难度系数越大，目标值就越小。  
哈希的有效性跟目标值密切相关，只有小于目标值的哈希才是有效的，否则哈希无效，必须重算。由于目标值非常小，哈希小于该值的机会极其渺茫，可能计算10亿次，才算中一次。这就是采矿如此之慢的根本原因。  
区块头里面所有的特征值都是固定的，为了让区块头产生变化，中本聪故意增加了一个随机项，叫做 Nonce。
####　难度系数的动态调节
为了将产出速率恒定在十分钟，中本聪还设计了难度系数的动态调节机制。他规定，难度系数每两周（2016个区块）调整一次。如果这两周里面，区块的平均生成速度是9分钟，就意味着比法定速度快了10%，因此接下来的难度系数就要调高10%；如果平均生成速度是11分钟，就意味着比法定速度慢了10%，因此接下来的难度系数就要调低10%。
难度系数越调越高（目标值越来越小），导致了采矿越来越难。

### 分叉
如果两个人同时向区块链写入数据，也就是说，同时有两个区块加入，因为它们都连着前一个区块，就形成了分叉。  
现在的规则是，新节点总是采用最长的那条区块链。如果区块链有分叉，将看哪个分支在分叉点后面，先达到6个新区块（称为"六次确认"）。按照10分钟一个区块计算，一小时就可以确认。

### 总结
区块链的适用场景，其实非常有限：
不存在所有成员都信任的管理当局
写入的数据不要求实时使用
挖矿的收益能够弥补本身的成本

#### 双重支付如何解决？

以比特币为代表的数字货币，关键的创新是通过时间戳（Timestamp）和工作量证明（Proof of Work）机制解决双重支付（Double 
Spending）和拜占庭将军问题（Byzantine Generals’ 
Problem），即保证同一笔比特币不会同时出现在两个地址[7]，并且在信道可靠的基础上，所有节点都可以让其它节点接收到自己的真实意图，并最终一致行动[16]。